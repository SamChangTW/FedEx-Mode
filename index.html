<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FedEx 模式｜OCR 商業發票 v1.7M-F-W-R2</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css" />
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
    }
  </script>
</head>
<body>
  <header>
    <h1>商業發票（OCR）</h1>
    <div class="sub">v1.7M-F-W-R2 · 手機版 · 鈦灰 × 香檳金</div>
  </header>

  <main>
    <section class="card">
      <h2>1) 掃描／手動輸入</h2>
      <div class="row" style="gap:8px; align-items:center; flex-wrap:wrap;">
        <button id="btnScanStart" type="button">啟用條碼/二維碼掃描</button>
        <button id="btnScanStop" type="button">停止掃描</button>
        <small id="barcodeStatus" style="opacity:.8"></small>
      </div>
      <video id="barcodeVideo" playsinline style="width:100%;max-height:220px;display:none;background:#000;border-radius:8px"></video>
      <!-- 已取消 OCR，保留純掃描與手動輸入流程 -->
    </section>

    <section class="card">
      <h2>2) 欄位確認</h2>
      <div class="grid">
        <label>AWB 編號
          <input id="awb" inputmode="numeric" placeholder="例如：772165000095" />
        </label>
        <label>發票日期
          <input id="date" placeholder="YYYY-MM-DD" />
        </label>
        <label class="full">寄件人（Sender）
          <input id="seller" placeholder="公司名稱或姓名" />
        </label>
        <label class="full">寄件人地址（Sender Address）
          <textarea id="sellerAddr" placeholder="街道與門牌號、城市、州/省、郵遞區號、國家" rows="2"></textarea>
        </label>
        <label class="full">收件人（Recipient）
          <input id="buyer" placeholder="公司名稱或姓名" />
        </label>
        <label class="full">收件人地址（Recipient Address）
          <textarea id="buyerAddr" placeholder="街道與門牌號、城市、州/省、郵遞區號、國家" rows="2"></textarea>
        </label>
        <label class="full">貨品說明（Description）
          <input id="desc" placeholder="例如：Paperboard Box" />
        </label>
        <label>金額（Amount / USD）
          <input id="amount" type="number" step="0.01" placeholder="數字，例如：120.00" />
        </label>
        <label>重量（Weight）
          <input id="weight" placeholder="例如：0.50 KG 或 1 LB" />
        </label>
        <label>件數（Pieces）
          <input id="pieces" inputmode="numeric" placeholder="例如：1" />
        </label>
      </div>
      <div class="row">
        <button id="btnRemap" type="button">重新自動帶入（OCR）</button>
        <button id="btnClear" type="button">清空欄位</button>
      </div>
    </section>

    <section class="card">
      <h2>3) 輸出</h2>
      <div class="row">
        <button id="btnPdf" type="button">生成 PDF（制式表格）</button>
        <span id="outStatus"></span>
      </div>
      <div class="row">
        <label style="display:flex;align-items:center;gap:8px;">
          <input id="useFedExTpl" type="checkbox" checked /> 使用 FedEx 官方版型（背景疊字）
        </label>
      </div>
      <div class="row" id="tplRow" style="display:flex;gap:8px;align-items:center;">
        <input id="tplInput" type="file" accept="image/png, image/jpeg, application/pdf" />
        <small>可上傳模板（PDF/PNG/JPG）。若留空，將嘗試載入 assets/ci_template.pdf 或 assets/ci_template.png</small>
      </div>
    </section>
  </main>

  <footer>
    <small>Public template · 無簽名 · 無 Logo · 僅必要欄位 · 可離線使用（PWA）</small>
  </footer>

  <!-- 已移除 tesseract.js（OCR 全數取消） -->
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <script src="https://unpkg.com/@zxing/library@0.20.0"></script>
  <script src="main.js"></script>
</body>
</html>
